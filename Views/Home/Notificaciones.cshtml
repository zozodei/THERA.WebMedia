@if(!String.IsNullOrEmpty(@ViewBag.msgError)){
     <h3 style="color: red">@ViewBag.msgError</h3>
}

@if(ViewBag.terapeutaActual != null)
{
    <div class="alert alert-warning text-center" style="font-size:17px;">
        Si aceptÃ¡s una solicitud, tu terapeuta actual 
        <strong>@ViewBag.terapeutaActual.Nombre @ViewBag.terapeutaActual.Apellido</strong> 
        dejarÃ¡ de serlo.
    </div>
}

@{
    List<Solicitudes> solicitudes = ViewBag.solicitudes as List<Solicitudes>;
    List<Terapeuta> terapeutas = ViewBag.terapeutas as List<Terapeuta>;
}

@if(solicitudes.Count == 0)
{
    <p class="text-center mt-4">No tenÃ©s notificaciones nuevas.</p>
}
else
{
    foreach(Solicitudes solicitud in @ViewBag.solicitudes)
    {
        Terapeuta terapeuta = terapeutas.FirstOrDefault(x => x.id == solicitud.idTerapeuta);

        <div class="card p-3 mb-3" style="display:flex; justify-content:space-between; align-items:center;">
            <div>
                <strong>@terapeuta.nombre @terapeuta.apellido</strong> quiere ser tu terapeuta.
            </div>

            <div style="display:flex; gap:10px;">
                <button class="btn btn-success" data-toggle="modal" data-target="#modalAceptar" 
                        onclick="setSolicitud(@solicitud.Id)">
                    âœ”
                </button>

                <form method="post" action="@Url.Action("eliminarSolicitud", "Home")" style="display:inline;">
                    <input type="hidden" name="idSolicitud" value="@solicitud.Id" />
                    <button class="btn btn-danger">ğŸ—‘ï¸</button>
                </form>
            </div>
        </div>
    }
}
<div class="modal fade" id="modalAceptar" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title">Confirmar aceptaciÃ³n</h5>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <div class="modal-body">
                @if (ViewBag.terapeutaActual == null)
                {
                    <p>
                        Â¿QuerÃ©s aceptar esta solicitud?  
                        Este terapeuta se convertirÃ¡ en tu terapeuta asignado.
                    </p>
                }
                else
                {
                    <p>
                        Â¿QuerÃ©s aceptar esta solicitud?  
                        <strong>@ViewBag.terapeutaActual.Nombre @ViewBag.terapeutaActual.Apellido</strong> dejarÃ¡ de ser tu terapeuta.
                    </p>
                }
            </div>

            <div class="modal-footer">
                <form method="post" action="/Paciente/AceptarSolicitud">
                    <input type="hidden" id="solicitud-id" name="idSolicitud" />
                    <button type="submit" class="btn btn-success">Aceptar</button>
                </form>

                <button class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
            </div>

        </div>
    </div>
</div>


<script>
    function setSolicitud(id) {
        document.getElementById("solicitud-id").value = id;
    }
</script>
